<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mask Detection System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation Header -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
                <span class="logo-text">MaskGuard</span>
            </div>
            <div class="nav-links">
                <a href="#live" class="nav-link active">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    <span class="nav-text">Live</span>
                </a>
                <a href="#how-to-use" class="nav-link">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <span class="nav-text">How to Use</span>
                </a>
                <a href="#contact" class="nav-link">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <span class="nav-text">Contact Me</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Audio Notification Toast -->
    <div id="audioNotification" class="audio-notification">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
            <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
        </svg>
        Click anywhere to enable audio alerts
    </div>

    <div class="container">
        <!-- Page Header -->
        <header class="header" id="live">
            <div class="header-content">
                <h1 class="title">Real-Time Mask Detection</h1>
                <p class="subtitle">AI-powered face mask compliance monitoring system</p>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-grid">
            <!-- Video Feed Section -->
            <div class="video-section">
                <div class="card video-card">
                    <div class="card-header">
                        <h2>Live Detection Feed</h2>
                        <div class="status-badge" id="statusBadge">
                            <span class="status-dot"></span>
                            <span id="statusText">Safe</span>
                        </div>
                    </div>
                    <div class="video-container">
                        <!-- Hidden video element for camera stream -->
                        <video id="cameraVideo" autoplay playsinline style="display: none;"></video>
                        <!-- Canvas for capturing and processing frames -->
                        <canvas id="processingCanvas" style="display: none;"></canvas>
                        <!-- Display canvas for showing results -->
                        <canvas id="displayCanvas"></canvas>
                        <div class="video-overlay" id="pausedOverlay">
                            <div class="pause-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="6" y="4" width="4" height="16"/>
                                    <rect x="14" y="4" width="4" height="16"/>
                                </svg>
                            </div>
                            <p>Detection Paused</p>
                        </div>
                        <div class="video-overlay" id="cameraError" style="display: none;">
                            <div class="pause-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="15" y1="9" x2="9" y2="15"/>
                                    <line x1="9" y1="9" x2="15" y2="15"/>
                                </svg>
                            </div>
                            <p id="cameraErrorText">Camera Error</p>
                        </div>
                    </div>
                    <div class="controls">
                        <button id="toggleBtn" class="btn btn-primary">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="6" y="4" width="4" height="16"/>
                                <rect x="14" y="4" width="4" height="16"/>
                            </svg>
                            Pause Detection
                        </button>
                        <button id="switchCameraBtn" class="btn btn-secondary" style="display: none;">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                                <circle cx="12" cy="13" r="4"/>
                                <path d="M17 8h.01"/>
                            </svg>
                            Switch Camera
                        </button>
                        <button id="resetBtn" class="btn btn-secondary">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 4v6h6M23 20v-6h-6"/>
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                            </svg>
                            Reset Statistics
                        </button>
                    </div>
                </div>
            </div>

            <!-- Statistics Section -->
            <div class="stats-section">
                <!-- Environment Status Card -->
                <div class="card status-card">
                    <h3 class="card-title">Environment Status</h3>
                    <div class="status-indicator" id="environmentStatus">
                        <div class="status-icon safe" id="statusIcon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                        </div>
                        <h2 class="status-title" id="environmentText">Environment Safe</h2>
                        <p class="status-description" id="safetyPercentage">100% Compliance</p>
                    </div>
                </div>

                <!-- Detection Statistics Card -->
                <div class="card stats-card">
                    <h3 class="card-title">Detection Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item stat-safe">
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                    <polyline points="22 4 12 14.01 9 11.01"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <p class="stat-label">With Mask</p>
                                <p class="stat-value" id="withMask">0</p>
                            </div>
                        </div>
                        <div class="stat-item stat-danger">
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="15" y1="9" x2="9" y2="15"/>
                                    <line x1="9" y1="9" x2="15" y2="15"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <p class="stat-label">Without Mask</p>
                                <p class="stat-value" id="withoutMask">0</p>
                            </div>
                        </div>
                        <div class="stat-item stat-warning">
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                    <line x1="12" y1="9" x2="12" y2="13"/>
                                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <p class="stat-label">Incorrect Mask</p>
                                <p class="stat-value" id="incorrectMask">0</p>
                            </div>
                        </div>
                        <div class="stat-item stat-info">
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
                                    <polyline points="13 2 13 9 20 9"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <p class="stat-label">Total Detections</p>
                                <p class="stat-value" id="totalDetections">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Last Violation Card -->
                <div class="card violation-card">
                    <h3 class="card-title">Last Violation</h3>
                    <div class="violation-content">
                        <p id="lastViolation" class="violation-text">No violations detected</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- How to Use Section -->
        <section id="how-to-use" class="info-section">
            <div class="card">
                <h2 class="section-title">How to Use</h2>
                <div class="info-content">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>Start Detection</h3>
                            <p>The system automatically starts detecting faces and mask compliance when you load the page.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Monitor Status</h3>
                            <p>Green boxes indicate proper mask wearing, while red boxes with alerts show violations.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Alert System</h3>
                            <p>Audio alerts play when violations are detected. If more than 2 people are non-compliant, you'll hear "Environment Not Safe".</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h3>Track Statistics</h3>
                            <p>View real-time statistics and compliance percentage. Use the reset button to clear all data.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="info-section">
            <div class="card">
                <h2 class="section-title">Contact Me</h2>
                <div class="contact-content">
                    <p class="contact-intro">Have questions or feedback? Feel free to reach out!</p>
                    <div class="contact-info">
                        <div class="contact-item">
                            <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                <polyline points="22,6 12,13 2,6"/>
                            </svg>
                            <span>Developer: Aina</span>
                        </div>
                        <div class="contact-item">
                            <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
                            </svg>
                            <span>Powered by Ultralytics YOLO</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <svg class="footer-logo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
                <span>MaskGuard Detection System</span>
            </div>
            <div class="footer-divider"></div>
            <div class="footer-info">
                <p>Developed by <strong>Aina</strong></p>
                <p>&copy; 2025 All Rights Reserved</p>
            </div>
        </div>
    </footer>

    <!-- Alarm Sound -->
    <audio id="alarmSound" preload="auto">
        <source src="{{ url_for('static', filename='sounds/beep-warning-6387.mp3') }}" type="audio/mpeg">
    </audio>

    <script src="{{ url_for('static', filename='js/camera.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>

